"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[971],{23391:function(le,N,s){s.r(N),s.d(N,{default:function(){return ae}});var H=s(15009),U=s.n(H),z=s(99289),W=s.n(z),K=s(5574),f=s.n(K),c=s(67294),Q=s(74981),oe=s(90252),ge=s(22777),e=s(85893),X=function(b){var S=b.value,m=S===void 0?{}:S,t=b.onChange,O=c.useState(JSON.stringify(m,null,2)),j=f()(O,2),p=j[0],d=j[1],I=c.useState(!0),C=f()(I,2),F=C[0],Z=C[1];(0,c.useEffect)(function(){var A=JSON.stringify(m),h=JSON.stringify(JSON.parse(p));A!==h&&d(JSON.stringify(m,null,2))},[m]);var v=function(h){d(h);try{var T=JSON.parse(h);Z(!0),t&&t(T)}catch(R){Z(!1)}};return(0,e.jsxs)("div",{style:{width:"100%"},children:[(0,e.jsx)(Q.ZP,{mode:"json",theme:"textmate",value:p,onChange:v,name:"json-editor",editorProps:{$blockScrolling:!0},height:"auto",maxLines:1/0,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:!0,tabSize:2,useWorker:!1},style:{width:"100%",minHeight:"80px"},fontSize:14,lineHeight:19,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0}),!F&&(0,e.jsx)("div",{style:{color:"red",marginTop:"8px"},children:"JSON \u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u8F93\u5165\uFF01"})]})},l=X,D=s(66927),Y=s(60219),k=s(90930),w=s(80854),a=s(53025),u=s(2453),q=s(74330),J=s(42075),_=s(38437),ee=s(83062),o=s(55102),E=s(14726),V=s(71230),L=s(15746),P=s(4393),i=s(72269),y=s(37804),g=s(85886),te=function(){var b=a.Z.useForm(),S=f()(b,1),m=S[0],t=(0,w.useIntl)(),O=(0,c.useState)(!1),j=f()(O,2),p=j[0],d=j[1],I=function(){d(!0),(0,D.iE)().then(function(r){d(!1),r.success&&m.setFieldsValue(r.data)})};(0,c.useEffect)(function(){I()},[]);var C=function(){m.validateFields().then(function(r){d(!0),(0,D.rF)(r).then(function(M){d(!1),M.success?(u.ZP.success(t.formatMessage({id:"pages.setting.saveSuccess"})),I()):u.ZP.error(M.message||t.formatMessage({id:"pages.setting.error"}))})}).catch(function(){u.ZP.error(t.formatMessage({id:"pages.setting.error"}))})},F=(0,c.useState)(""),Z=f()(F,2),v=Z[0],A=Z[1],h=(0,c.useState)(""),T=f()(h,2),R=T[0],ne=T[1],ie=function(){var x=W()(U()().mark(function r(M,G){var $,B;return U()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d(!0),$={Host:M,ApiSecret:G},n.next=5,(0,D.gU)($);case 5:B=n.sent,B.success?u.ZP.success(t.formatMessage({id:"pages.setting.migrateSuccess"})):u.ZP.error(B.message),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),u.ZP.error(n.t0);case 12:return n.prev=12,d(!1),n.finish(12);case 15:case"end":return n.stop()}},r,null,[[0,9,12,15]])}));return function(M,G){return x.apply(this,arguments)}}(),re=function(){v?ie(v,R):u.ZP.warning(t.formatMessage({id:"pages.setting.migrateTips"}))};return(0,e.jsx)(k._z,{children:(0,e.jsx)(a.Z,{form:m,labelAlign:"left",layout:"horizontal",labelCol:{span:6},wrapperCol:{span:18},children:(0,e.jsxs)(q.Z,{spinning:p,children:[(0,e.jsxs)(J.Z,{style:{marginBottom:"10px",display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)(_.Z,{type:"info",style:{paddingTop:"4px",paddingBottom:"4px"},description:t.formatMessage({id:"pages.setting.tips"})}),(0,e.jsxs)(J.Z,{children:[(0,e.jsx)(ee.Z,{placement:"bottom",title:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:8},children:[(0,e.jsx)(o.Z,{style:{marginBottom:8},placeholder:"mjplus host",value:v,onChange:function(r){return A(r.target.value)}}),(0,e.jsx)(o.Z,{placeholder:"mj-api-secret",value:R,onChange:function(r){return ne(r.target.value)}})]}),children:(0,e.jsx)(E.ZP,{loading:p,type:"primary",ghost:!0,onClick:re,children:t.formatMessage({id:"pages.setting.migrate"})})}),(0,e.jsx)(E.ZP,{loading:p,icon:(0,e.jsx)(Y.Z,{}),type:"primary",onClick:C,children:t.formatMessage({id:"pages.setting.save"})})]})]}),(0,e.jsxs)(V.Z,{gutter:16,children:[(0,e.jsx)(L.Z,{span:12,children:(0,e.jsxs)(P.Z,{title:t.formatMessage({id:"pages.setting.accountSetting"}),bordered:!1,children:[(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableSwagger"}),name:"enableSwagger",extra:m.getFieldValue("enableSwagger")?(0,e.jsx)("a",{href:"/swagger",target:"_blank",rel:"noreferrer",children:t.formatMessage({id:"pages.setting.swaggerLink"})}):"",children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.mongoDefaultConnectionString"}),name:"mongoDefaultConnectionString",children:(0,e.jsx)(o.Z,{placeholder:"mongodb://mongoadmin:***admin@192.168.x.x"})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.mongoDefaultDatabase"}),name:"mongoDefaultDatabase",children:(0,e.jsx)(o.Z,{placeholder:"mj"})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.isMongoAutoMigrate"}),name:"isMongoAutoMigrate",tooltip:t.formatMessage({id:"pages.setting.isMongoAutoMigrateTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.maxCount"}),name:"maxCount",children:(0,e.jsx)(y.Z,{min:-1})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.accountChooseRule"}),name:"accountChooseRule",children:(0,e.jsxs)(g.Z,{allowClear:!0,children:[(0,e.jsx)(g.Z.Option,{value:"BestWaitIdle",children:"BestWaitIdle"}),(0,e.jsx)(g.Z.Option,{value:"Random",children:"Random"}),(0,e.jsx)(g.Z.Option,{value:"Weight",children:"Weight"}),(0,e.jsx)(g.Z.Option,{value:"Polling",children:"Polling"})]})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.discordConfig"}),name:"ngDiscord",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.proxyConfig"}),name:"proxy",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.aliyunOss"}),name:"aliyunOss",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.replicate"}),name:"replicate",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.translate"}),name:"translateWay",children:(0,e.jsxs)(g.Z,{allowClear:!0,children:[(0,e.jsx)(g.Z.Option,{value:"NULL",children:"NULL"}),(0,e.jsx)(g.Z.Option,{value:"BAIDU",children:"BAIDU"}),(0,e.jsx)(g.Z.Option,{value:"GPT",children:"GPT"})]})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.baiduTranslate"}),name:"baiduTranslate",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.openai"}),name:"openai",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.smtp"}),name:"smtp",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.notifyHook"}),name:"notifyHook",children:(0,e.jsx)(o.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.notifyPoolSize"}),name:"notifyPoolSize",children:(0,e.jsx)(y.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.captchaServer"}),name:"captchaServer",children:(0,e.jsx)(o.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.captchaNotifyHook"}),name:"captchaNotifyHook",children:(0,e.jsx)(o.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.captchaNotifySecret"}),name:"captchaNotifySecret",tooltip:t.formatMessage({id:"pages.setting.captchaNotifySecretTip"}),children:(0,e.jsx)(o.Z,{})})]})}),(0,e.jsx)(L.Z,{span:12,children:(0,e.jsxs)(P.Z,{title:t.formatMessage({id:"pages.setting.otherSetting"}),bordered:!1,children:[(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.isVerticalDomain"}),name:"isVerticalDomain",help:t.formatMessage({id:"pages.setting.isVerticalDomainTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableRegister"}),name:"enableRegister",children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.registerUserDefaultDayLimit"}),name:"registerUserDefaultDayLimit",children:(0,e.jsx)(y.Z,{min:-1})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableGuest"}),name:"enableGuest",children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.guestDefaultDayLimit"}),name:"guestDefaultDayLimit",children:(0,e.jsx)(y.Z,{min:-1})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.bannedLimiting"}),name:"bannedLimiting",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.ipRateLimiting"}),name:"ipRateLimiting",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.ipBlackRateLimiting"}),name:"ipBlackRateLimiting",children:(0,e.jsx)(l,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.notify"}),name:"notify",children:(0,e.jsx)(o.Z.TextArea,{autoSize:{minRows:1,maxRows:10}})})]})})]}),(0,e.jsx)(V.Z,{gutter:16,style:{marginTop:"16px"},children:(0,e.jsx)(L.Z,{span:12,children:(0,e.jsxs)(P.Z,{title:t.formatMessage({id:"pages.setting.discordSetting"}),bordered:!1,children:[(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableAutoGetPrivateId"}),name:"enableAutoGetPrivateId",help:t.formatMessage({id:"pages.setting.enableAutoGetPrivateIdTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableAutoVerifyAccount"}),name:"enableAutoVerifyAccount",help:t.formatMessage({id:"pages.setting.enableAutoVerifyAccountTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableAutoSyncInfoSetting"}),name:"enableAutoSyncInfoSetting",help:t.formatMessage({id:"pages.setting.enableAutoSyncInfoSettingTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableAutoExtendToken"}),name:"enableAutoExtendToken",help:t.formatMessage({id:"pages.setting.enableAutoExtendTokenTips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableUserCustomUploadBase64"}),name:"enableUserCustomUploadBase64",help:t.formatMessage({id:"pages.setting.enableUserCustomUploadBase64Tips"}),children:(0,e.jsx)(i.Z,{})}),(0,e.jsx)(a.Z.Item,{label:t.formatMessage({id:"pages.setting.enableConvertOfficialLink"}),name:"enableConvertOfficialLink",help:t.formatMessage({id:"pages.setting.enableConvertOfficialLinkTips"}),children:(0,e.jsx)(i.Z,{})})]})})})]})})})},ae=te}}]);
