"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{12154:function(ne,b,i){i.r(b),i.d(b,{default:function(){return Ie}});var D=i(97857),A=i.n(D),O=i(15009),v=i.n(O),j=i(99289),S=i.n(j),N=i(5574),p=i.n(N),P=i(27986),U=i(94272),m=i(66309),J=i(38703),le=i(83062),R=i(11499),M=i(74330),l=i(26412),K=i(86250),L=i(4393),e=i(85893),oe=function(V){var t=V.record,o=(0,U.useIntl)(),Z=sessionStorage.getItem("mj-image-prefix")||"",w=function(s){var g="default";return s=="NOT_START"?g="default":s=="SUBMITTED"?g="lime":s=="MODAL"?g="warning":s=="IN_PROGRESS"?g="processing":s=="FAILURE"?g="error":s=="SUCCESS"?g="success":s=="CANCEL"&&(g="magenta"),(0,e.jsx)(m.Z,{color:g,children:t.displays.status})},F=function(s){var g=0;s&&s.indexOf("%")>0&&(g=parseInt(s.substring(0,s.indexOf("%"))));var y="normal";return t.status=="SUCCESS"?y="success":t.status=="FAILURE"&&(y="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(J.Z,{percent:g,status:y})})},h=function(s){return!s||s.length<30?s:(0,e.jsx)(le.Z,{title:s,children:s.substring(0,30)+"..."})},E=function(s){return s&&(0,e.jsx)(R.Z,{width:200,src:Z+s,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},B=function(s){return s&&(0,e.jsx)("video",{width:"200",controls:!0,src:Z+s,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},W=function(){return!t.videoUrls||t.videoUrls.length===0?null:(0,e.jsxs)("div",{className:"video-task-detail",children:[(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(m.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(m.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),(0,e.jsx)("div",{className:"videos-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:t.videoUrls.map(function(s,g){return(0,e.jsx)("div",{className:"video-detail-item",children:(0,e.jsxs)("div",{style:{position:"relative",marginBottom:"8px"},children:[(0,e.jsxs)("video",{controls:!0,loop:!0,muted:!0,style:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"8px"},poster:t.videoGenOriginImageUrl,children:[(0,e.jsx)("source",{src:s.url,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E\u3002"]}),(0,e.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["#",g+1]})]})},g)})}),t.videoGenOriginImageUrl&&(0,e.jsxs)("div",{style:{marginTop:"16px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px",fontWeight:"bold"},children:"\u539F\u59CB\u56FE\u7247:"}),E(t.videoGenOriginImageUrl)]})]})},G=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(m.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"||s=="FACE_SWAP"||s=="FACE_SWAP_VIDEO"?(0,e.jsx)(m.Z,{color:"volcano",children:"InsightFace"}):s=="MID_JOURNEY"?(0,e.jsx)(m.Z,{color:"blue",children:"Midjourney"}):"-"},z=function(s){if(!(s==null||!s))return(0,e.jsx)(m.Z,{color:"green",children:o.formatMessage({id:"pages.yes"})})},$=function(){return t.action==="SWAP_VIDEO_FACE"||t.contentType==="video/mp4"?(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.video"}),children:(0,e.jsxs)(K.Z,{vertical:!0,children:[t.videoDuration&&(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(m.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(m.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),B(t.imageUrl)]})}):(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.image"}),children:(0,e.jsxs)(K.Z,{vertical:!0,children:[t.videoDuration&&(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(m.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(m.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),E(t.imageUrl)]})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.Z,{type:"inner",title:o.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(l.Z,{column:2,children:[(0,e.jsx)(l.Z.Item,{label:"ID",children:t.id}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.type"}),children:t.displays.action}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.status"}),children:w(t.status)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.progress"}),children:F(t.progress)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.prompt"}),children:h(t.prompt)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.promptEn"}),children:h(t.promptEn)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.description"}),children:h(t.description)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.submitTime"}),children:t.displays.submitTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.startTime"}),children:t.displays.startTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finishTime"}),children:t.displays.finishTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.failReason"}),children:h(t.failReason)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.state"}),children:h(t.state)}),$()]})}),(0,e.jsx)(L.Z,{type:"inner",title:o.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(l.Z,{column:2,children:[(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.botType"}),children:G(t.botType)}),(0,e.jsx)(l.Z.Item,{label:"Nonce",children:t.nonce}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.account.channelId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.instanceId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(l.Z.Item,{label:"Hash",children:t.properties.messageHash}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.messageContent"}),children:h(t.properties.messageContent)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finalPrompt"}),children:h(t.properties.finalPrompt)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finalPromptZh"}),children:h(t.promptCn||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.actionId"}),children:h(t.properties.custom_id||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.modalConfirm"}),children:z(t.properties.needModel)||"-"}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.imageSeed"}),children:t.seed||"-"}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.notifyHook"}),children:h(t.properties.notifyHook||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.ip"}),children:t.clientIp||"-"})]})})]})},de=oe,X=i(66927),ue=i(74842),ce=i(82061),ge=i(90930),me=i(99191),fe=i(53025),pe=i(16568),Y=i(28036),he=i(86738),ve=i(28248),I=i(67294),xe=function(){var V=(0,I.useState)(!1),t=p()(V,2),o=t[0],Z=t[1],w=(0,I.useState)({}),F=p()(w,2),h=F[0],E=F[1],B=(0,I.useState)(""),W=p()(B,2),G=W[0],z=W[1],$=(0,I.useState)({}),x=p()($,2),s=x[0],g=x[1],y=(0,I.useState)(1e3),Q=p()(y,2),Se=Q[0],Me=Q[1],Ce=fe.Z.useForm(),Ze=p()(Ce,1),Ee=Ze[0],c=(0,U.useIntl)(),ye=sessionStorage.getItem("mj-image-prefix")||"",Te=pe.ZP.useNotification(),q=p()(Te,2),_=q[0],be=q[1],ee=(0,I.useRef)(),Ae=function(){E({}),g({}),Z(!1)},Ue=function(r,a,n,d){Ee.resetFields(),z(r),E(a),g(n),Me(d),Z(!0)},Re=function(){var u=S()(v()().mark(function r(a){var n,d;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,(0,X._5)(a);case 3:n=f.sent,n.success?(_.success({message:"success",description:c.formatMessage({id:"pages.task.deleteSuccess"})}),(d=ee.current)===null||d===void 0||d.reload()):_.error({message:"error",description:n.message}),f.next=10;break;case 7:f.prev=7,f.t0=f.catch(0),console.error(f.t0);case 10:return f.prev=10,f.finish(10);case 12:case"end":return f.stop()}},r,null,[[0,7,10,12]])}));return function(a){return u.apply(this,arguments)}}(),Fe=(0,I.useState)(!0),te=p()(Fe,2),H=te[0],ke=te[1],ae=function(){ke(!1)},we=function(r){return r&&(0,e.jsx)("video",{width:"200",controls:!0,src:ye+r,placeholder:(0,e.jsx)(M.Z,{tip:"Loading",size:"large"})})},De=(0,I.useState)(!1),se=p()(De,2),Oe=se[0],re=se[1],Ne=(0,I.useState)(""),ie=p()(Ne,2),Pe=ie[0],Le=ie[1],Ve=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(r,a){return(0,e.jsx)("a",{onClick:function(){return Ue(c.formatMessage({id:"pages.task.info"}),(0,e.jsx)(de,{record:a}),null,1100)},children:r})}},{title:c.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"},{label:"SwapVideoFace",value:"SWAP_VIDEO_FACE"},{label:"Video",value:"VIDEO"},{label:"Edit",value:"EDIT"},{label:"Retexture",value:"RETEXTURE"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.displays.action}},{title:c.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(r,a,n){return a.action==="SWAP_VIDEO_FACE"?a.thumbnailUrl&&(0,e.jsx)(R.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:a.thumbnailUrl,preview:!1,onClick:function(){window.open(a.imageUrl)},loading:"lazy",onLoad:ae,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(M.Z,{spinning:H})})},n):a.contentType==="video/mp4"?(0,e.jsx)("div",{style:{position:"relative",cursor:"pointer",display:"inline-block"},onClick:function(){Le(a.imageUrl||a.url),re(!0)},children:(0,e.jsx)(Y.ZP,{icon:(0,e.jsx)(ue.Z,{})})}):(a.thumbnailUrl||a.imageUrl)&&(0,e.jsx)(R.Z.PreviewGroup,{items:a.images||[],children:(0,e.jsx)(R.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:a.action==="VIDEO"?a.imageUrl:a.thumbnailUrl||a.imageUrl,preview:{src:a.imageUrl,mask:(0,e.jsx)(M.Z,{spinning:H})},loading:"lazy",onLoad:ae,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(M.Z,{spinning:H})})},n)})}},{title:c.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(r,a){return a.properties.discordInstanceId}},{title:c.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(r,a){return a.displays.submitTime}},{title:c.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:c.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:c.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:c.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:c.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:c.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:c.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:c.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){var n="default";return r=="NOT_START"?n="default":r=="SUBMITTED"?n="lime":r=="MODAL"?n="warning":r=="IN_PROGRESS"?n="processing":r=="FAILURE"?n="error":r=="SUCCESS"?n="success":r=="CANCEL"&&(n="magenta"),(0,e.jsx)(m.Z,{color:n,children:a.displays.status})}},{title:c.formatMessage({id:"pages.task.mode"}),dataIndex:"mode",width:90,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"RELAX",value:"RELAX"},{label:"FAST",value:"FAST"},{label:"TURBO",value:"TURBO"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.mode||"FAST"}},{title:c.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(r,a){var n=0;r&&r.indexOf("%")>0&&(n=parseInt(r.substring(0,r.indexOf("%"))));var d="normal";return a.status=="SUCCESS"?d="success":a.status=="FAILURE"&&(d="exception"),(0,e.jsx)(J.Z,{percent:n,status:d,size:"small"})}},{title:c.formatMessage({id:"pages.task.useTime"}),dataIndex:"useTime",width:80,ellipsis:!0},{title:c.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:c.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:c.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(r,a){return(0,e.jsx)(he.Z,{title:c.formatMessage({id:"pages.task.delete"}),description:c.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Re(a.id)},children:(0,e.jsx)(Y.ZP,{danger:!0,icon:(0,e.jsx)(ce.Z,{})})})}}];return(0,e.jsxs)(ge._z,{children:[be,(0,e.jsx)(L.Z,{children:(0,e.jsx)(me.Z,{columns:Ve,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:ee,request:function(){var u=S()(v()().mark(function r(a){var n,d,k;return v()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,X.Pn)(A()(A()({},a),{},{pageNumber:a.current-1}));case 2:return n=C.sent,d=n.list.map(function(T){return T.imageUrl||""}).filter(function(T){return T!=""}),k=n.list,k.forEach(function(T,Be){T.images=d}),C.abrupt("return",{data:k,total:n.pagination.total,success:!0});case 7:case"end":return C.stop()}},r)}));return function(r){return u.apply(this,arguments)}}()})}),(0,e.jsx)(P.Z,{title:G,modalVisible:o,hideModal:Ae,modalContent:h,footer:s,modalWidth:Se}),(0,e.jsx)(ve.Z,{title:"\u89C6\u9891\u64AD\u653E",open:Oe,onCancel:function(){return re(!1)},footer:null,width:800,centered:!0,destroyOnClose:!0,children:(0,e.jsxs)("video",{controls:!0,autoPlay:!0,width:"100%",style:{maxHeight:"400px"},children:[(0,e.jsx)("source",{src:Pe,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E"]})})]})},Ie=xe},27986:function(ne,b,i){var D=i(28248),A=i(85893),O=function(j){var S=j.title,N=j.modalVisible,p=j.hideModal,P=j.modalContent,U=j.footer,m=j.modalWidth;return(0,A.jsx)(D.Z,{title:S,open:N,onCancel:p,footer:U,width:m,children:P})};b.Z=O}}]);
