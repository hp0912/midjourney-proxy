"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[903],{43705:function(zr,je,o){o.r(je),o.d(je,{default:function(){return Ma}});var ca=o(97857),T=o.n(ca),pa=o(15009),I=o.n(pa),ga=o(64599),q=o.n(ga),fa=o(19632),ma=o.n(fa),va=o(99289),z=o.n(va),ha=o(5574),m=o.n(ha),x=o(66927),Sa=o(18429),ba=o(51042),ye=o(52645),Ca=o(90930),ja=o(94272),W=o(26915),se=o(4393),ya=o(16568),b=o(2453),A=o(28036),wa=o(7134),O=o(86250),_=o(42075),Ta=o(66309),Ia=o(11499),we=o(74330),xa=o(38703),N=o(66476),Te=o(78045),Ie=o(74656),Pa=o(72269),Za=o(28248),p=o(67294),xe=o(87419),de={cardTitleTime:"cardTitleTime___ULudn",taskErrorTip:"taskErrorTip___EJ9yV","videos-container":"videos-container___OhNQp","video-item":"video-item___z87Fy","video-wrapper":"video-wrapper___ZpmfN","video-player":"video-player___sVGXY","video-overlay":"video-overlay___CdOP6","video-actions":"video-actions___mWn0D","button-group":"button-group___gweCL","group-label":"group-label___mIcIE","group-buttons":"group-buttons___mGTvE","ant-btn":"ant-btn___O07ju","action-btn":"action-btn___d6WZz",secondary:"secondary___XbL5f","btn-emoji":"btn-emoji___tSdOt","btn-label":"btn-label___e_LaX","task-header":"task-header___hSKmm","task-info":"task-info___sGARu","task-meta":"task-meta___kz8_A"},a=o(85893),ne=W.Z.TextArea,Aa=se.Z.Meta,Ea=function(){var Fa=ya.ZP.useNotification(),Pe=m()(Fa,2),L=Pe[0],Ra=Pe[1],ka=(0,p.useState)([]),Ze=m()(ka,2),Ua=Ze[0],Ae=Ze[1],Oa=(0,p.useState)(!1),Ee=m()(Oa,2),La=Ee[0],Me=Ee[1],Ba=(0,p.useState)("imagine"),Fe=m()(Ba,2),j=Fe[0],Da=Fe[1],Na=(0,p.useState)("MID_JOURNEY"),Re=m()(Na,2),w=Re[0],Ja=Re[1],Wa=(0,p.useState)(""),ke=m()(Wa,2),E=ke[0],V=ke[1],Va=(0,p.useState)("SQUARE"),Ue=m()(Va,2),Oe=Ue[0],Ga=Ue[1],Ha=(0,p.useState)([]),Le=m()(Ha,2),B=Le[0],G=Le[1],za=(0,p.useState)([]),Be=m()(za,2),R=Be[0],ee=Be[1],Ya=(0,p.useState)([]),De=m()(Ya,2),k=De[0],ae=De[1],$a=(0,p.useState)(""),Ne=m()($a,2),Xa=Ne[0],Je=Ne[1],Qa=(0,p.useState)(!1),We=m()(Qa,2),J=We[0],P=We[1],Ka=(0,p.useState)(new Set),qa=m()(Ka,1),y=qa[0],_a=(0,p.useState)(!1),Ve=m()(_a,2),er=Ve[0],Y=Ve[1],ar=(0,p.useState)(""),Ge=m()(ar,2),rr=Ge[0],tr=Ge[1],sr=(0,p.useState)(""),He=m()(sr,2),ie=He[0],ze=He[1],nr=(0,p.useState)(""),Ye=m()(nr,2),ce=Ye[0],ir=Ye[1],or=(0,p.useState)(""),$e=m()(or,2),oe=$e[0],Xe=$e[1],lr=(0,p.useState)(0),Qe=m()(lr,2),Ke=Qe[0],ur=Qe[1],dr=(0,p.useState)(!1),qe=m()(dr,2),cr=qe[0],pr=qe[1],gr=(0,p.useState)(!1),_e=m()(gr,2),fr=_e[0],ea=_e[1],mr=(0,p.useState)([]),aa=m()(mr,2),vr=aa[0],hr=aa[1],Sr=(0,p.useState)(),ra=m()(Sr,2),$=ra[0],br=ra[1],Cr=(0,p.useState)(function(){var n=sessionStorage.getItem("mj-remix-mode");return n==="true"}),ta=m()(Cr,2),sa=ta[0],jr=ta[1],u=(0,ja.useIntl)(),pe=(0,p.useRef)([]),X=(0,p.useRef)(null),D="midjourney-proxy-admin",ge=sessionStorage.getItem("mj-image-prefix")||"";(0,p.useEffect)(function(){return Tr({state:D,pageNumber:0,pageSize:3,statusSet:["NOT_START","SUBMITTED","IN_PROGRESS","FAILURE","SUCCESS"],sort:"submitTime,desc"}),X.current&&clearInterval(X.current),X.current=setInterval(function(){y.size!==0&&yr()},2e3),function(){X.current&&(clearInterval(X.current),X.current=null)}},[]);var yr=function(){var n=z()(I()().mark(function e(){var r,l,i,f,s,g,c,F,v,h,C;return I()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return r=Array.from(y),l=new Set(r),S.next=4,(0,x.BX)(r);case 4:i=S.sent,f=!1,s=ma()(pe.current),g=q()(i),S.prev=8,F=I()().mark(function K(){var U,t;return I()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:U=c.value,l.delete(U.id),(U.status==="FAILURE"||U.status==="SUCCESS"||U.status==="CANCEL")&&y.delete(U.id),t=s.find(function(Hr){return Hr.id===U.id}),t?wr(t,U)||(f=!0,s.splice(s.indexOf(t),1,U)):(f=!0,s.push(U));case 5:case"end":return Z.stop()}},K)}),g.s();case 11:if((c=g.n()).done){S.next=15;break}return S.delegateYield(F(),"t0",13);case 13:S.next=11;break;case 15:S.next=20;break;case 17:S.prev=17,S.t1=S.catch(8),g.e(S.t1);case 20:return S.prev=20,g.f(),S.finish(20);case 23:v=q()(l);try{for(v.s();!(h=v.n()).done;)C=h.value,y.delete(C)}catch(K){v.e(K)}finally{v.f()}f&&(pe.current=s,Ae(s),na());case 26:case"end":return S.stop()}},e,null,[[8,17,20,23]])}));return function(){return n.apply(this,arguments)}}(),wr=function(e,r){return e.status===r.status&&e.progress===r.progress&&e.imageUrl===r.imageUrl},na=function(){setTimeout(function(){var e=document.getElementById("task-panel");e&&e.scrollTo(0,e.scrollHeight)},20)},Tr=function(){var n=z()(I()().mark(function e(r){var l,i,f,s,g,c;return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return Me(!0),v.next=3,(0,x.Ed)();case 3:return l=v.sent,hr(l),v.next=7,(0,x.Pn)(r);case 7:i=v.sent,f=i.list.reverse(),s=q()(f);try{for(s.s();!(g=s.n()).done;)c=g.value,c.status!=="FAILURE"&&c.status!=="SUCCESS"&&c.action!=="CANCEL"&&y.add(c.id)}catch(h){s.e(h)}finally{s.f()}pe.current=f,Ae(f),Me(!1),na();case 15:case"end":return v.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),Ir=function(e){Da(e),V(""),G([])},xr=function(e){br(e)},Pr=function(e){var r=e.target.value;Ja(r),V(""),G([])},Zr=function(e){var r=e.target.value;Ga(r)},le=function(e){V(e.target.value)},ia=function(e){ze(e.target.value)},Q=function(){var n=z()(I()().mark(function e(r){return I()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise(function(f){var s=new FileReader;s.onload=function(){return f(s.result)},s.readAsDataURL(r)});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),M=function(){var n=z()(I()().mark(function e(){var r,l,i,f,s,g,c,F,v,h,C,te,S,K;return I()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(w==="INSIGHT_FACE"||w==="FACE_SWAP")){t.next=26;break}if(!(R.length<1)){t.next=4;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 4:if(!(k.length<1)){t.next=7;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 7:if(P(!0),r={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){t.next=15;break}return t.next=12,Q(R[0].originFileObj);case 12:r.sourceBase64=t.sent,t.next=16;break;case 15:r.sourceUrl=R[0].name;case 16:if(!k[0].originFileObj){t.next=22;break}return t.next=19,Q(k[0].originFileObj);case 19:r.targetBase64=t.sent,t.next=23;break;case 22:r.targetUrl=k[0].name;case 23:(0,x.Vl)(r).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),y.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),t.next=143;break;case 26:if(w!=="VIDEO_FACE_SWAP"){t.next=51;break}if(!(R.length<1)){t.next=30;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 30:if(!(k.length<1)){t.next=33;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 33:if(P(!0),l={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){t.next=41;break}return t.next=38,Q(R[0].originFileObj);case 38:l.sourceBase64=t.sent,t.next=42;break;case 41:l.sourceUrl=R[0].name;case 42:i=new FormData,k[0].originFileObj?i.append("TargetFile",k[0].originFileObj):l.targetUrl=k[0].name,i.append("SourceBase64",l.sourceBase64||""),i.append("SourceUrl",l.sourceUrl||""),i.append("TargetUrl",l.targetUrl||""),i.append("Satate",l.state),(0,x.Wv)(i,{headers:{"Content-Type":"multipart/form-data"}}).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),y.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),t.next=143;break;case 51:if(j!=="show"){t.next=59;break}if(E){t.next=55;break}return b.ZP.error(u.formatMessage({id:"pages.draw.taskIdNotBlank"})),t.abrupt("return");case 55:y.add(E),V(""),t.next=143;break;case 59:if(j!=="showjobid"){t.next=67;break}if(E){t.next=63;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 63:P(!0),(0,x.cq)("show",{botType:w,jobId:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var Z=re(d);Z&&(y.add(d.result),V(""),G([]))}),t.next=143;break;case 67:if(j!=="imagine"){t.next=95;break}if(E){t.next=71;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 71:P(!0),f=[],s=q()(B),t.prev=74,s.s();case 76:if((g=s.n()).done){t.next=84;break}return c=g.value,t.next=80,Q(c.originFileObj);case 80:F=t.sent,f.push(F);case 82:t.next=76;break;case 84:t.next=89;break;case 86:t.prev=86,t.t0=t.catch(74),s.e(t.t0);case 89:return t.prev=89,s.f(),t.finish(89);case 92:(0,x.qJ)(j,{botType:w,prompt:E,base64Array:f,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var Z=re(d);Z&&(y.add(d.result),V(""),G([]))}),t.next=143;break;case 95:if(j!=="blend"){t.next=123;break}if(!(B.length<2)){t.next=99;break}return b.ZP.error(u.formatMessage({id:"pages.draw.blendTip"})),t.abrupt("return");case 99:P(!0),v=[],h=q()(B),t.prev=102,h.s();case 104:if((C=h.n()).done){t.next=112;break}return te=C.value,t.next=108,Q(te.originFileObj);case 108:S=t.sent,v.push(S);case 110:t.next=104;break;case 112:t.next=117;break;case 114:t.prev=114,t.t1=t.catch(102),h.e(t.t1);case 117:return t.prev=117,h.f(),t.finish(117);case 120:(0,x.qJ)(j,{botType:w,base64Array:v,dimensions:Oe,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var Z=re(d);Z&&(y.add(d.result),G([]))}),t.next=143;break;case 123:if(j!=="describe"){t.next=134;break}if(!(B.length<1)){t.next=127;break}return b.ZP.error(u.formatMessage({id:"pages.draw.imageEmptyTip"})),t.abrupt("return");case 127:return P(!0),t.next=130,Q(B[0].originFileObj);case 130:K=t.sent,(0,x.qJ)(j,{botType:w,base64:K,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var Z=re(d);Z&&(y.add(d.result),G([]))}),t.next=143;break;case 134:if(j!=="shorten"){t.next=142;break}if(E){t.next=138;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 138:P(!0),(0,x.qJ)(j,{botType:w,prompt:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var Z=re(d);Z&&(y.add(d.result),V(""))}),t.next=143;break;case 142:b.ZP.error(u.formatMessage({id:"pages.draw.unsupportedAction"}));case 143:case"end":return t.stop()}},e,null,[[74,86,89,92],[102,114,117,120]])}));return function(){return n.apply(this,arguments)}}(),re=function(e){return e.code===22||e.code===1?(e.code===22?L.warning({message:"warn",description:e.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),!0):(L.error({message:"error",description:e.description}),!1)},Ar=function(e,r){var l=r.customId,i=e.id,f="".concat(r.emoji," ").concat(r.label);Je("".concat(i,":").concat(l)),(0,x.qJ)("action",{taskId:i,customId:l,state:D,chooseSameChannel:!0,enableRemix:sa}).then(function(s){if(Je(""),s.code===22)L.warning({message:"warn",description:s.description}),r.style=3,y.add(s.result);else if(s.code===21){if(r.style=3,tr("".concat(s.result," ").concat(f)),ir(s.result),ze(s.properties.finalPrompt),pr(s.properties.remix||!1),l.startsWith("MJ::Inpaint:")){var g="".concat(ge).concat(e.imageUrl),c=new Image;c.src=g,c.onload=function(){ur(Math.floor(550/c.width*c.height)),Xe(g),Y(!0),setTimeout(function(){Mr()},300)}}else Xe(""),Y(!0);Y(!0)}else if(s.code===1){if(r.style=3,s.result){var F=s.result.split(",");F.forEach(function(v){y.add(v)})}b.ZP.success(u.formatMessage({id:"pages.draw.actionSuccess"}))}else L.error({message:"error",description:s.description})})},Er=function(e){jr(e),sessionStorage.setItem("mj-remix-mode",e?"true":"false")},fe=!1,me=0,ve=0,Mr=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getBoundingClientRect(),l=Math.floor(r.left),i=Math.floor(r.top),f=e.getContext("2d");f.fillStyle="blue",e.onmousedown=function(s){me=s.clientX,ve=s.clientY,fe=!0},e.onmousemove=function(s){fe===!0&&f.fillRect(me-l,ve-i,s.clientX-me,s.clientY-ve)},e.onmouseup=function(){fe=!1}},Fr=function(){(0,x.el)(ce),Y(!1)},Rr=function(){var n=z()(I()().mark(function e(){var r,l,i,f;return I()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(ea(!0),!oe){g.next=11;break}return l=document.getElementById("canvas"),i=new Image,i.src=l.toDataURL("image/png"),g.next=7,kr(i);case 7:f=g.sent,r={maskBase64:f,taskId:ce,prompt:ie},g.next=12;break;case 11:r={taskId:ce,prompt:ie};case 12:(0,x.qJ)("modal",r).then(function(c){ea(!1),c.code===22?(L.warning({message:"warn",description:c.description}),y.add(c.result),Y(!1)):c.code===1?(y.add(c.result),Y(!1),b.ZP.success(u.formatMessage({id:"pages.draw.subSuccess"}))):L.error({message:"error",description:c.description})});case 13:case"end":return g.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),kr=function(){var n=z()(I()().mark(function e(r){return I()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise(function(f){r.onload=function(){var s=r.width,g=r.height,c=document.createElement("canvas"),F=c.getContext("2d");c.width=s,c.height=g,F.drawImage(r,0,0,s,g);for(var v=F.getImageData(0,0,s,g),h=v.data,C=0;C<h.length;C+=4)h[C]!==0||h[C+1]!==0||h[C+2]!==0?(h[C]=parseInt("0xff"),h[C+1]=parseInt("0xff"),h[C+2]=parseInt("0xff")):(h[C]=0,h[C+1]=0,h[C+2]=0,h[C+3]=255);F.putImageData(v,0,0);var te=c.toDataURL("png");f(te)}});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),Ur=function(e){var r="Midjourney - ".concat(e.displays.discordInstanceId);return e.botType==="NIJI_JOURNEY"?r="niji\u30FBjourney - ".concat(e.displays.discordInstanceId):(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP")&&(r="InsightFaceSwap - ".concat(e.displays.discordInstanceId)),e.status!=="SUCCESS"&&e.status!=="FAILURE"&&e.status!=="CANCEL"&&e.action!=="SWAP_FACE"?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime}),(0,a.jsx)(A.ZP,{style:{marginLeft:"10px"},type:"link",shape:"circle",icon:(0,a.jsx)(Sa.Z,{}),onClick:function(){return(0,x.el)(e.id)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime})]})},Or=function(e){var r=e.description,l=e.properties.messageContent;return l&&(r=l.replace(/<@[^>]+>/g,"")),(0,a.jsx)(xe.U,{children:r})},Lr=function(){return Ua.map(function(e){var r="./midjourney.webp";return e.botType==="NIJI_JOURNEY"?r="./niji.webp":(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP"||e.botType==="VIDEO_FACE_SWAP")&&(r="./insightface.webp"),(0,a.jsxs)(se.Z,{bordered:!1,bodyStyle:{backgroundColor:"#eaeaea",marginBottom:"10px"},children:[(0,a.jsx)(Aa,{avatar:(0,a.jsx)(wa.C,{src:r}),title:Ur(e),description:Or(e)}),(0,a.jsxs)(O.Z,{vertical:!0,style:{paddingLeft:"48px"},children:[Jr(e),(0,a.jsx)(_.Z,{wrap:!0,style:{marginTop:"7px"},children:Nr(e)})]})]},e.id)})},ue=function(e){if(!e.properties.finalPrompt)return(0,a.jsx)(a.Fragment,{});var r=e.properties.finalPrompt;return(0,a.jsx)(xe.U,{children:r.replace(new RegExp("(?<!\\n)\\n","g"),`

`)})},he=function(e){if(e.status==="FAILURE")return(0,a.jsx)("span",{className:de.taskErrorTip,children:e.failReason});if(e.status==="SUCCESS")return(0,a.jsx)(a.Fragment,{});if(e.status==="IN_PROGRESS")return(0,a.jsx)(a.Fragment,{children:Dr(e)});var r="purple";return e.status==="SUBMITTED"?r="lime":e.status==="CANCEL"?r="magenta":e.status==="MODAL"&&(r="warning"),(0,a.jsx)("span",{children:(0,a.jsx)(Ta.Z,{color:r,children:e.displays.status})})},oa=function(e,r){return e?(0,a.jsx)(Ia.Z,{width:r,src:"".concat(ge).concat(e),placeholder:(0,a.jsx)(we.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Br=function(e,r){return e?(0,a.jsx)("video",{width:r,controls:!0,src:ge+e,placeholder:(0,a.jsx)(we.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Dr=function(e){var r=e.progress,l=0;return r&&r.indexOf("%")>0&&(l=parseInt(r.substring(0,r.indexOf("%")))),(0,a.jsx)("span",{style:{width:250},children:(0,a.jsx)(xa.Z,{percent:l,status:"normal"})})},Nr=function(e){return e.buttons.map(function(r){return(0,a.jsxs)(A.ZP,{ghost:!0,style:{backgroundColor:r.style===3?"#258146":"rgb(131 133 142)"},onClick:function(){Ar(e,r)},loading:Xa==="".concat(e.id,":").concat(r.customId),children:[r.emoji," ",r.label]},"".concat(e.id,":").concat(r.customId))})},H=(0,a.jsxs)("div",{children:[(0,a.jsx)(ba.Z,{}),(0,a.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),Jr=function(e){return e.action==="DESCRIBE"?(0,a.jsxs)(a.Fragment,{children:[he(e)," ",ue(e)," ",oa(e.imageUrl,120)]}):e.action==="SHORTEN"?(0,a.jsxs)(a.Fragment,{children:[he(e)," ",ue(e)]}):(0,a.jsxs)(a.Fragment,{children:[he(e),e.action==="VIDEO"&&e.videoDuration&&(0,a.jsxs)(a.Fragment,{children:[ue(e),(0,a.jsx)("div",{className:"task-header",children:(0,a.jsxs)("div",{className:"task-meta",children:[(0,a.jsxs)("span",{className:"task-duration",children:[e.videoDuration,"s"]}),(0,a.jsxs)("span",{className:"task-frames",children:[e.frameCount," frames"]})]})})]}),e.action==="SWAP_VIDEO_FACE"||e.contentType==="video/mp4"?(0,a.jsxs)(a.Fragment,{children:[ue(e),Br(e.imageUrl,250)]}):oa(e.imageUrl,250)]})},Wr=function(){return w==="INSIGHT_FACE"||w==="FACE_SWAP"?(0,a.jsxs)(O.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2Desc"})}),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapDesc"})})]}):w==="VIDEO_FACE_SWAP"?(0,a.jsxs)(O.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2VidelDesc"})}),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapVideoDesc"})})]}):j==="show"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputIdShow"}),value:E,onChange:le,onPressEnter:M}),(0,a.jsx)(A.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):j==="showjobid"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputJobIdShow"}),value:E,onChange:le,onPressEnter:M}),(0,a.jsx)(A.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):j==="imagine"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},Ce),{},{listType:"picture-card",children:B.length>=5?null:H})),(0,a.jsxs)(O.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:E,onChange:le,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(A.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):j==="blend"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},Ce),{},{listType:"picture-card",children:B.length>=5?null:H})),(0,a.jsxs)(_.Z,{style:{width:"100%",marginTop:"10px"},children:[(0,a.jsx)(Te.ZP.Group,{value:Oe,onChange:Zr,options:[{value:"PORTRAIT",label:u.formatMessage({id:"pages.draw.PORTRAIT"})},{value:"SQUARE",label:u.formatMessage({id:"pages.draw.SQUARE"})},{value:"LANDSCAPE",label:u.formatMessage({id:"pages.draw.LANDSCAPE"})}],optionType:"button"}),(0,a.jsx)(A.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):j==="describe"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},Ce),{},{listType:"picture-card",children:B.length>=1?null:H})),(0,a.jsx)(A.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):j==="shorten"?(0,a.jsxs)(O.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:E,onChange:le,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(A.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):(0,a.jsx)(a.Fragment,{})},la=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getContext("2d");r.fillStyle="blue"},Vr=function(){return oe?cr?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(A.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(ye.Z,{}),onClick:la,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke}),(0,a.jsx)(ne,{style:{marginTop:"10px"},rows:2,value:ie,onChange:ia})]}):(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(A.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(ye.Z,{}),onClick:la,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke})]}):(0,a.jsx)(ne,{rows:3,value:ie,onChange:ia})};function Se(n){n.onSuccess()}var be=function(e){var r=e.type==="image/jpeg"||e.type==="image/png"||e.type==="video/mp4"||e.type==="image/webp";r||b.ZP.error(u.formatMessage({id:"pages.draw.onlyJpgPng"}));var l=e.size/1024/1024<10;return l||b.ZP.error(u.formatMessage({id:"pages.draw.limit10M"})),r&&l||N.Z.LIST_IGNORE},Ce={customRequest:Se,beforeUpload:be,fileList:B,onChange:function(e){G(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},ua={customRequest:Se,beforeUpload:be,maxCount:1,fileList:R,onChange:function(e){ee(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},da={customRequest:Se,beforeUpload:be,maxCount:1,fileList:k,onChange:function(e){ae(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},Gr=function(){var e,r=!1;w==="INSIGHT_FACE"||w==="FACE_SWAP"||w==="VIDEO_FACE_SWAP"?(r=!0,e=[{value:"swap",label:"/swap"}]):e=[{value:"imagine",label:"/imagine"},{value:"blend",label:"/blend"},{value:"describe",label:"/describe"},{value:"shorten",label:"/shorten"},{value:"showjobid",label:"/show job_id"},{value:"show",label:"/show task_id"}];var l=vr.map(function(i){return{value:i.channelId,label:i.channelId+" - "+(i.remark||""),disabled:!i.enable||!i.running}});return(0,a.jsxs)(_.Z,{style:{marginBottom:"10px"},children:[(0,a.jsx)(Ie.Z,{value:r?"swap":j,style:{width:150},onChange:Ir,options:e}),(0,a.jsx)(Pa.Z,{checked:sa,onChange:Er,checkedChildren:"Remix",unCheckedChildren:"Remix"}),(0,a.jsx)(Ie.Z,{value:$,style:{width:320},onChange:xr,options:l,allowClear:!0,placeholder:u.formatMessage({id:"pages.draw.selectAccount"})}),(0,a.jsx)(Te.ZP.Group,{value:w,onChange:Pr,options:[{value:"MID_JOURNEY",label:"Midjourney"},{value:"NIJI_JOURNEY",label:"niji\u30FBjourney"},{value:"FACE_SWAP",label:"FaceSwap"},{value:"VIDEO_FACE_SWAP",label:"Video\u30FBFaceSwap"}],optionType:"button"})]})};return(0,a.jsxs)(Ca._z,{children:[Ra,(0,a.jsx)(se.Z,{style:{marginBottom:"15px",overflow:"auto",height:"70vh"},loading:La,id:"task-panel",children:Lr()}),(0,a.jsxs)(se.Z,{children:[Gr(),Wr()]}),(0,a.jsx)(Za.Z,{title:rr,open:er,onCancel:Fr,onOk:Rr,confirmLoading:fr,width:600,children:Vr()})]})},Ma=Ea}}]);
