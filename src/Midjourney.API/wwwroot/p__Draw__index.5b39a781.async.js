"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[903],{43705:function(Nr,Ce,l){l.r(Ce),l.d(Ce,{default:function(){return Aa}});var ua=l(97857),T=l.n(ua),da=l(15009),I=l.n(da),ca=l(64599),q=l.n(ca),pa=l(19632),ga=l.n(pa),fa=l(99289),z=l.n(fa),ma=l(5574),m=l.n(ma),x=l(66927),va=l(18429),ha=l(51042),we=l(52645),Sa=l(90930),ba=l(94272),W=l(26915),se=l(4393),ya=l(16568),b=l(2453),Z=l(28036),Ca=l(7134),O=l(86250),_=l(42075),wa=l(66309),ja=l(11499),je=l(74330),Ta=l(38703),N=l(66476),Te=l(78045),Ie=l(74656),Ia=l(28248),g=l(67294),xe=l(87419),de={cardTitleTime:"cardTitleTime___ULudn",taskErrorTip:"taskErrorTip___EJ9yV","videos-container":"videos-container___OhNQp","video-item":"video-item___z87Fy","video-wrapper":"video-wrapper___ZpmfN","video-player":"video-player___sVGXY","video-overlay":"video-overlay___CdOP6","video-actions":"video-actions___mWn0D","button-group":"button-group___gweCL","group-label":"group-label___mIcIE","group-buttons":"group-buttons___mGTvE","ant-btn":"ant-btn___O07ju","action-btn":"action-btn___d6WZz",secondary:"secondary___XbL5f","btn-emoji":"btn-emoji___tSdOt","btn-label":"btn-label___e_LaX","task-header":"task-header___hSKmm","task-info":"task-info___sGARu","task-meta":"task-meta___kz8_A"},a=l(85893),ne=W.Z.TextArea,xa=se.Z.Meta,Pa=function(){var Za=ya.ZP.useNotification(),Pe=m()(Za,2),L=Pe[0],Ea=Pe[1],Ma=(0,g.useState)([]),Ae=m()(Ma,2),Fa=Ae[0],Ze=Ae[1],Ra=(0,g.useState)(!1),Ee=m()(Ra,2),ka=Ee[0],Me=Ee[1],Ua=(0,g.useState)("imagine"),Fe=m()(Ua,2),C=Fe[0],Oa=Fe[1],La=(0,g.useState)("MID_JOURNEY"),Re=m()(La,2),j=Re[0],Ba=Re[1],Da=(0,g.useState)(""),ke=m()(Da,2),E=ke[0],V=ke[1],Na=(0,g.useState)("SQUARE"),Ue=m()(Na,2),Oe=Ue[0],Ja=Ue[1],Wa=(0,g.useState)([]),Le=m()(Wa,2),B=Le[0],G=Le[1],Va=(0,g.useState)([]),Be=m()(Va,2),R=Be[0],ee=Be[1],Ga=(0,g.useState)([]),De=m()(Ga,2),k=De[0],ae=De[1],Ha=(0,g.useState)(""),Ne=m()(Ha,2),za=Ne[0],Je=Ne[1],Ya=(0,g.useState)(!1),We=m()(Ya,2),J=We[0],P=We[1],$a=(0,g.useState)(new Set),Xa=m()($a,1),w=Xa[0],Qa=(0,g.useState)(!1),Ve=m()(Qa,2),Ka=Ve[0],Y=Ve[1],qa=(0,g.useState)(""),Ge=m()(qa,2),_a=Ge[0],er=Ge[1],ar=(0,g.useState)(""),He=m()(ar,2),ie=He[0],ze=He[1],rr=(0,g.useState)(""),Ye=m()(rr,2),ce=Ye[0],tr=Ye[1],sr=(0,g.useState)(""),$e=m()(sr,2),le=$e[0],Xe=$e[1],nr=(0,g.useState)(0),Qe=m()(nr,2),Ke=Qe[0],ir=Qe[1],lr=(0,g.useState)(!1),qe=m()(lr,2),or=qe[0],ur=qe[1],dr=(0,g.useState)(!1),_e=m()(dr,2),cr=_e[0],ea=_e[1],pr=(0,g.useState)([]),aa=m()(pr,2),gr=aa[0],fr=aa[1],mr=(0,g.useState)(),ra=m()(mr,2),$=ra[0],vr=ra[1],u=(0,ba.useIntl)(),pe=(0,g.useRef)([]),X=(0,g.useRef)(null),D="midjourney-proxy-admin",ge=sessionStorage.getItem("mj-image-prefix")||"";(0,g.useEffect)(function(){return br({state:D,pageNumber:0,pageSize:3,statusSet:["NOT_START","SUBMITTED","IN_PROGRESS","FAILURE","SUCCESS"],sort:"submitTime,desc"}),X.current&&clearInterval(X.current),X.current=setInterval(function(){w.size!==0&&hr()},2e3),function(){X.current&&(clearInterval(X.current),X.current=null)}},[]);var hr=function(){var n=z()(I()().mark(function e(){var r,o,i,f,s,p,c,F,v,h,y;return I()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return r=Array.from(w),o=new Set(r),S.next=4,(0,x.BX)(r);case 4:i=S.sent,f=!1,s=ga()(pe.current),p=q()(i),S.prev=8,F=I()().mark(function K(){var U,t;return I()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:U=c.value,o.delete(U.id),(U.status==="FAILURE"||U.status==="SUCCESS"||U.status==="CANCEL")&&w.delete(U.id),t=s.find(function(Dr){return Dr.id===U.id}),t?Sr(t,U)||(f=!0,s.splice(s.indexOf(t),1,U)):(f=!0,s.push(U));case 5:case"end":return A.stop()}},K)}),p.s();case 11:if((c=p.n()).done){S.next=15;break}return S.delegateYield(F(),"t0",13);case 13:S.next=11;break;case 15:S.next=20;break;case 17:S.prev=17,S.t1=S.catch(8),p.e(S.t1);case 20:return S.prev=20,p.f(),S.finish(20);case 23:v=q()(o);try{for(v.s();!(h=v.n()).done;)y=h.value,w.delete(y)}catch(K){v.e(K)}finally{v.f()}f&&(pe.current=s,Ze(s),ta());case 26:case"end":return S.stop()}},e,null,[[8,17,20,23]])}));return function(){return n.apply(this,arguments)}}(),Sr=function(e,r){return e.status===r.status&&e.progress===r.progress&&e.imageUrl===r.imageUrl},ta=function(){setTimeout(function(){var e=document.getElementById("task-panel");e&&e.scrollTo(0,e.scrollHeight)},20)},br=function(){var n=z()(I()().mark(function e(r){var o,i,f,s,p,c;return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return Me(!0),v.next=3,(0,x.Ed)();case 3:return o=v.sent,fr(o),v.next=7,(0,x.Pn)(r);case 7:i=v.sent,f=i.list.reverse(),s=q()(f);try{for(s.s();!(p=s.n()).done;)c=p.value,c.status!=="FAILURE"&&c.status!=="SUCCESS"&&c.action!=="CANCEL"&&w.add(c.id)}catch(h){s.e(h)}finally{s.f()}pe.current=f,Ze(f),Me(!1),ta();case 15:case"end":return v.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),yr=function(e){Oa(e),V(""),G([])},Cr=function(e){vr(e)},wr=function(e){var r=e.target.value;Ba(r),V(""),G([])},jr=function(e){var r=e.target.value;Ja(r)},oe=function(e){V(e.target.value)},sa=function(e){ze(e.target.value)},Q=function(){var n=z()(I()().mark(function e(r){return I()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise(function(f){var s=new FileReader;s.onload=function(){return f(s.result)},s.readAsDataURL(r)});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),M=function(){var n=z()(I()().mark(function e(){var r,o,i,f,s,p,c,F,v,h,y,te,S,K;return I()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(j==="INSIGHT_FACE"||j==="FACE_SWAP")){t.next=26;break}if(!(R.length<1)){t.next=4;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 4:if(!(k.length<1)){t.next=7;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 7:if(P(!0),r={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){t.next=15;break}return t.next=12,Q(R[0].originFileObj);case 12:r.sourceBase64=t.sent,t.next=16;break;case 15:r.sourceUrl=R[0].name;case 16:if(!k[0].originFileObj){t.next=22;break}return t.next=19,Q(k[0].originFileObj);case 19:r.targetBase64=t.sent,t.next=23;break;case 22:r.targetUrl=k[0].name;case 23:(0,x.Vl)(r).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),w.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),t.next=143;break;case 26:if(j!=="VIDEO_FACE_SWAP"){t.next=51;break}if(!(R.length<1)){t.next=30;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 30:if(!(k.length<1)){t.next=33;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),t.abrupt("return");case 33:if(P(!0),o={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){t.next=41;break}return t.next=38,Q(R[0].originFileObj);case 38:o.sourceBase64=t.sent,t.next=42;break;case 41:o.sourceUrl=R[0].name;case 42:i=new FormData,k[0].originFileObj?i.append("TargetFile",k[0].originFileObj):o.targetUrl=k[0].name,i.append("SourceBase64",o.sourceBase64||""),i.append("SourceUrl",o.sourceUrl||""),i.append("TargetUrl",o.targetUrl||""),i.append("Satate",o.state),(0,x.Wv)(i,{headers:{"Content-Type":"multipart/form-data"}}).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),w.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),t.next=143;break;case 51:if(C!=="show"){t.next=59;break}if(E){t.next=55;break}return b.ZP.error(u.formatMessage({id:"pages.draw.taskIdNotBlank"})),t.abrupt("return");case 55:w.add(E),V(""),t.next=143;break;case 59:if(C!=="showjobid"){t.next=67;break}if(E){t.next=63;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 63:P(!0),(0,x.cq)("show",{botType:j,jobId:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var A=re(d);A&&(w.add(d.result),V(""),G([]))}),t.next=143;break;case 67:if(C!=="imagine"){t.next=95;break}if(E){t.next=71;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 71:P(!0),f=[],s=q()(B),t.prev=74,s.s();case 76:if((p=s.n()).done){t.next=84;break}return c=p.value,t.next=80,Q(c.originFileObj);case 80:F=t.sent,f.push(F);case 82:t.next=76;break;case 84:t.next=89;break;case 86:t.prev=86,t.t0=t.catch(74),s.e(t.t0);case 89:return t.prev=89,s.f(),t.finish(89);case 92:(0,x.qJ)(C,{botType:j,prompt:E,base64Array:f,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var A=re(d);A&&(w.add(d.result),V(""),G([]))}),t.next=143;break;case 95:if(C!=="blend"){t.next=123;break}if(!(B.length<2)){t.next=99;break}return b.ZP.error(u.formatMessage({id:"pages.draw.blendTip"})),t.abrupt("return");case 99:P(!0),v=[],h=q()(B),t.prev=102,h.s();case 104:if((y=h.n()).done){t.next=112;break}return te=y.value,t.next=108,Q(te.originFileObj);case 108:S=t.sent,v.push(S);case 110:t.next=104;break;case 112:t.next=117;break;case 114:t.prev=114,t.t1=t.catch(102),h.e(t.t1);case 117:return t.prev=117,h.f(),t.finish(117);case 120:(0,x.qJ)(C,{botType:j,base64Array:v,dimensions:Oe,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var A=re(d);A&&(w.add(d.result),G([]))}),t.next=143;break;case 123:if(C!=="describe"){t.next=134;break}if(!(B.length<1)){t.next=127;break}return b.ZP.error(u.formatMessage({id:"pages.draw.imageEmptyTip"})),t.abrupt("return");case 127:return P(!0),t.next=130,Q(B[0].originFileObj);case 130:K=t.sent,(0,x.qJ)(C,{botType:j,base64:K,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var A=re(d);A&&(w.add(d.result),G([]))}),t.next=143;break;case 134:if(C!=="shorten"){t.next=142;break}if(E){t.next=138;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),t.abrupt("return");case 138:P(!0),(0,x.qJ)(C,{botType:j,prompt:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var A=re(d);A&&(w.add(d.result),V(""))}),t.next=143;break;case 142:b.ZP.error(u.formatMessage({id:"pages.draw.unsupportedAction"}));case 143:case"end":return t.stop()}},e,null,[[74,86,89,92],[102,114,117,120]])}));return function(){return n.apply(this,arguments)}}(),re=function(e){return e.code===22||e.code===1?(e.code===22?L.warning({message:"warn",description:e.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),!0):(L.error({message:"error",description:e.description}),!1)},Tr=function(e,r){var o=r.customId,i=e.id,f="".concat(r.emoji," ").concat(r.label);Je("".concat(i,":").concat(o)),(0,x.qJ)("action",{taskId:i,customId:o,state:D,chooseSameChannel:!0}).then(function(s){if(Je(""),s.code===22)L.warning({message:"warn",description:s.description}),r.style=3,w.add(s.result);else if(s.code===21){if(r.style=3,er("".concat(s.result," ").concat(f)),tr(s.result),ze(s.properties.finalPrompt),ur(s.properties.remix||!1),o.startsWith("MJ::Inpaint:")){var p="".concat(ge).concat(e.imageUrl),c=new Image;c.src=p,c.onload=function(){ir(Math.floor(550/c.width*c.height)),Xe(p),Y(!0),setTimeout(function(){Ir()},300)}}else Xe(""),Y(!0);Y(!0)}else if(s.code===1){if(r.style=3,s.result){var F=s.result.split(",");F.forEach(function(v){w.add(v)})}b.ZP.success(u.formatMessage({id:"pages.draw.actionSuccess"}))}else L.error({message:"error",description:s.description})})},fe=!1,me=0,ve=0,Ir=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getBoundingClientRect(),o=Math.floor(r.left),i=Math.floor(r.top),f=e.getContext("2d");f.fillStyle="blue",e.onmousedown=function(s){me=s.clientX,ve=s.clientY,fe=!0},e.onmousemove=function(s){fe===!0&&f.fillRect(me-o,ve-i,s.clientX-me,s.clientY-ve)},e.onmouseup=function(){fe=!1}},xr=function(){(0,x.el)(ce),Y(!1)},Pr=function(){var n=z()(I()().mark(function e(){var r,o,i,f;return I()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(ea(!0),!le){p.next=11;break}return o=document.getElementById("canvas"),i=new Image,i.src=o.toDataURL("image/png"),p.next=7,Ar(i);case 7:f=p.sent,r={maskBase64:f,taskId:ce,prompt:ie},p.next=12;break;case 11:r={taskId:ce,prompt:ie};case 12:(0,x.qJ)("modal",r).then(function(c){ea(!1),c.code===22?(L.warning({message:"warn",description:c.description}),w.add(c.result),Y(!1)):c.code===1?(w.add(c.result),Y(!1),b.ZP.success(u.formatMessage({id:"pages.draw.subSuccess"}))):L.error({message:"error",description:c.description})});case 13:case"end":return p.stop()}},e)}));return function(){return n.apply(this,arguments)}}(),Ar=function(){var n=z()(I()().mark(function e(r){return I()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise(function(f){r.onload=function(){var s=r.width,p=r.height,c=document.createElement("canvas"),F=c.getContext("2d");c.width=s,c.height=p,F.drawImage(r,0,0,s,p);for(var v=F.getImageData(0,0,s,p),h=v.data,y=0;y<h.length;y+=4)h[y]!==0||h[y+1]!==0||h[y+2]!==0?(h[y]=parseInt("0xff"),h[y+1]=parseInt("0xff"),h[y+2]=parseInt("0xff")):(h[y]=0,h[y+1]=0,h[y+2]=0,h[y+3]=255);F.putImageData(v,0,0);var te=c.toDataURL("png");f(te)}});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},e)}));return function(r){return n.apply(this,arguments)}}(),Zr=function(e){var r="Midjourney - ".concat(e.displays.discordInstanceId);return e.botType==="NIJI_JOURNEY"?r="niji\u30FBjourney - ".concat(e.displays.discordInstanceId):(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP")&&(r="InsightFaceSwap - ".concat(e.displays.discordInstanceId)),e.status!=="SUCCESS"&&e.status!=="FAILURE"&&e.status!=="CANCEL"&&e.action!=="SWAP_FACE"?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime}),(0,a.jsx)(Z.ZP,{style:{marginLeft:"10px"},type:"link",shape:"circle",icon:(0,a.jsx)(va.Z,{}),onClick:function(){return(0,x.el)(e.id)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime})]})},Er=function(e){var r=e.description,o=e.properties.messageContent;return o&&(r=o.replace(/<@[^>]+>/g,"")),(0,a.jsx)(xe.U,{children:r})},Mr=function(){return Fa.map(function(e){var r="./midjourney.webp";return e.botType==="NIJI_JOURNEY"?r="./niji.webp":(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP"||e.botType==="VIDEO_FACE_SWAP")&&(r="./insightface.webp"),(0,a.jsxs)(se.Z,{bordered:!1,bodyStyle:{backgroundColor:"#eaeaea",marginBottom:"10px"},children:[(0,a.jsx)(xa,{avatar:(0,a.jsx)(Ca.C,{src:r}),title:Zr(e),description:Er(e)}),(0,a.jsxs)(O.Z,{vertical:!0,style:{paddingLeft:"48px"},children:[Ur(e),(0,a.jsx)(_.Z,{wrap:!0,style:{marginTop:"7px"},children:kr(e)})]})]},e.id)})},na=function(e){if(!e.properties.finalPrompt)return(0,a.jsx)(a.Fragment,{});var r=e.properties.finalPrompt;return(0,a.jsx)(xe.U,{children:r.replace(new RegExp("(?<!\\n)\\n","g"),`

`)})},ue=function(e){if(e.status==="FAILURE")return(0,a.jsx)("span",{className:de.taskErrorTip,children:e.failReason});if(e.status==="SUCCESS")return(0,a.jsx)(a.Fragment,{});if(e.status==="IN_PROGRESS")return(0,a.jsx)(a.Fragment,{children:Rr(e)});var r="purple";return e.status==="SUBMITTED"?r="lime":e.status==="CANCEL"?r="magenta":e.status==="MODAL"&&(r="warning"),(0,a.jsx)("span",{children:(0,a.jsx)(wa.Z,{color:r,children:e.displays.status})})},he=function(e,r){return e?(0,a.jsx)(ja.Z,{width:r,src:"".concat(ge).concat(e),placeholder:(0,a.jsx)(je.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Fr=function(e,r){return e?(0,a.jsx)("video",{width:r,controls:!0,src:ge+e,placeholder:(0,a.jsx)(je.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Rr=function(e){var r=e.progress,o=0;return r&&r.indexOf("%")>0&&(o=parseInt(r.substring(0,r.indexOf("%")))),(0,a.jsx)("span",{style:{width:250},children:(0,a.jsx)(Ta.Z,{percent:o,status:"normal"})})},kr=function(e){return e.buttons.map(function(r){return(0,a.jsxs)(Z.ZP,{ghost:!0,style:{backgroundColor:r.style===3?"#258146":"rgb(131 133 142)"},onClick:function(){Tr(e,r)},loading:za==="".concat(e.id,":").concat(r.customId),children:[r.emoji," ",r.label]},"".concat(e.id,":").concat(r.customId))})},H=(0,a.jsxs)("div",{children:[(0,a.jsx)(ha.Z,{}),(0,a.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),Ur=function(e){return e.action==="DESCRIBE"?(0,a.jsxs)(a.Fragment,{children:[ue(e)," ",na(e)," ",he(e.imageUrl,120)]}):e.action==="SHORTEN"?(0,a.jsxs)(a.Fragment,{children:[ue(e)," ",na(e)]}):e.action==="VIDEO"||e.action==="VIDEO_EXTEND"?(0,a.jsxs)("div",{className:"video-task-card",children:[ue(e),he(e.imageUrl,250)]}):(0,a.jsxs)(a.Fragment,{children:[ue(e),e.action==="SWAP_VIDEO_FACE"||e.contentType==="video/mp4"?(0,a.jsx)(a.Fragment,{children:Fr(e.imageUrl,250)}):he(e.imageUrl,250)]})},Or=function(){return j==="INSIGHT_FACE"||j==="FACE_SWAP"?(0,a.jsxs)(O.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,T()(T()({},la),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,T()(T()({},oa),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2Desc"})}),(0,a.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapDesc"})})]}):j==="VIDEO_FACE_SWAP"?(0,a.jsxs)(O.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(N.Z,T()(T()({},la),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(N.Z,T()(T()({},oa),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2VidelDesc"})}),(0,a.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapVideoDesc"})})]}):C==="show"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputIdShow"}),value:E,onChange:oe,onPressEnter:M}),(0,a.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="showjobid"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputJobIdShow"}),value:E,onChange:oe,onPressEnter:M}),(0,a.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="imagine"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:B.length>=5?null:H})),(0,a.jsxs)(O.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:E,onChange:oe,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="blend"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:B.length>=5?null:H})),(0,a.jsxs)(_.Z,{style:{width:"100%",marginTop:"10px"},children:[(0,a.jsx)(Te.ZP.Group,{value:Oe,onChange:jr,options:[{value:"PORTRAIT",label:u.formatMessage({id:"pages.draw.PORTRAIT"})},{value:"SQUARE",label:u.formatMessage({id:"pages.draw.SQUARE"})},{value:"LANDSCAPE",label:u.formatMessage({id:"pages.draw.LANDSCAPE"})}],optionType:"button"}),(0,a.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="describe"?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:B.length>=1?null:H})),(0,a.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="shorten"?(0,a.jsxs)(O.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:E,onChange:oe,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):(0,a.jsx)(a.Fragment,{})},ia=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getContext("2d");r.fillStyle="blue"},Lr=function(){return le?or?(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(Z.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(we.Z,{}),onClick:ia,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(le,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke}),(0,a.jsx)(ne,{style:{marginTop:"10px"},rows:2,value:ie,onChange:sa})]}):(0,a.jsxs)(O.Z,{vertical:!0,children:[(0,a.jsx)(Z.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(we.Z,{}),onClick:ia,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(le,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke})]}):(0,a.jsx)(ne,{rows:3,value:ie,onChange:sa})};function Se(n){n.onSuccess()}var be=function(e){var r=e.type==="image/jpeg"||e.type==="image/png"||e.type==="video/mp4"||e.type==="image/webp";r||b.ZP.error(u.formatMessage({id:"pages.draw.onlyJpgPng"}));var o=e.size/1024/1024<10;return o||b.ZP.error(u.formatMessage({id:"pages.draw.limit10M"})),r&&o||N.Z.LIST_IGNORE},ye={customRequest:Se,beforeUpload:be,fileList:B,onChange:function(e){G(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},la={customRequest:Se,beforeUpload:be,maxCount:1,fileList:R,onChange:function(e){ee(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},oa={customRequest:Se,beforeUpload:be,maxCount:1,fileList:k,onChange:function(e){ae(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},Br=function(){var e,r=!1;j==="INSIGHT_FACE"||j==="FACE_SWAP"||j==="VIDEO_FACE_SWAP"?(r=!0,e=[{value:"swap",label:"/swap"}]):e=[{value:"imagine",label:"/imagine"},{value:"blend",label:"/blend"},{value:"describe",label:"/describe"},{value:"shorten",label:"/shorten"},{value:"showjobid",label:"/show job_id"},{value:"show",label:"/show task_id"}];var o=gr.map(function(i){return{value:i.channelId,label:i.channelId+" - "+(i.remark||""),disabled:!i.enable||!i.running}});return(0,a.jsxs)(_.Z,{style:{marginBottom:"10px"},children:[(0,a.jsx)(Ie.Z,{value:r?"swap":C,style:{width:150},onChange:yr,options:e}),(0,a.jsx)(Ie.Z,{value:$,style:{width:320},onChange:Cr,options:o,allowClear:!0,placeholder:u.formatMessage({id:"pages.draw.selectAccount"})}),(0,a.jsx)(Te.ZP.Group,{value:j,onChange:wr,options:[{value:"MID_JOURNEY",label:"Midjourney"},{value:"NIJI_JOURNEY",label:"niji\u30FBjourney"},{value:"FACE_SWAP",label:"FaceSwap"},{value:"VIDEO_FACE_SWAP",label:"Video\u30FBFaceSwap"}],optionType:"button"})]})};return(0,a.jsxs)(Sa._z,{children:[Ea,(0,a.jsx)(se.Z,{style:{marginBottom:"15px",overflow:"auto",height:"70vh"},loading:ka,id:"task-panel",children:Mr()}),(0,a.jsxs)(se.Z,{children:[Br(),Or()]}),(0,a.jsx)(Ia.Z,{title:_a,open:Ka,onCancel:xr,onOk:Pr,confirmLoading:cr,width:600,children:Lr()})]})},Aa=Pa}}]);
